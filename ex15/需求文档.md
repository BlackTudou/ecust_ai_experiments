## 实验原理
（一）PCA 故障诊断原理
主成分分析（PCA）通过对高维过程变量进行线性变换，提取累计方差贡献率较高的主成分（PCs），构建正常工况的统计模型。利用 T² 统计量（衡量样本与模型的整体偏离程度）和 SPE 统计量（残差平方和，衡量未被主成分解释的变异）作为故障检测指标：当样本的 T² 或 SPE 值超出 99% 置信水平的控制限时，判定为故障。通过贡献图分析各变量对统计量超标的贡献度，实现故障隔离。

（二）PLS 故障诊断原理
偏最小二乘（PLS）同时考虑过程变量（X）与质量变量（Y）的相关性，构建 X→Y 的回归模型。通过计算预测误差平方和（PRESS）检测故障：故障样本会因过程波动导致质量变量预测值与实际值偏差增大，PRESS 超出控制限即判定为故障。结合载荷矩阵可分析过程变量与质量变量的关联，追溯故障对产品质量的影响路径。

## 实验数据集说明


|数据特征 | 具体内容                                                                         |
|--------|----------------------------------------------------------------------------------|
|变量构成 | 14 个过程变量（温度、压力、进料流量、催化剂浓度等）+ 5 个质量变量（密度、熔融指数等）|
|数据规模 | 54 个观测值：前 50 个为正常工况（共因运行），后 4 个为故障工况（两区域乙烯进料杂质升高）|
|数据性质 | 模拟串联管状反应堆 LDPE 生产过程数据，变量间存在强耦合关系 |


## 实验步骤

（一）实验准备
1. 实验数据文件 data/exp16_data_LDPE.csv，查看数据结构，确认变量顺序（前 14 列过程变量、后 5 列质量变量）。
2. 熟悉实验原理，明确数据预处理、模型训练、故障检测、结果分析的核心步骤。

（二）数据预处理（必做步骤）
1. 数据加载：读取 data/exp16_data_LDPE.csv 文件，分离正常样本（前 50 行）和故障样本（后 4 行），分别提取过程变量 X 和质量变量 Y。
2. 数据标准化：对正常样本的 X 和 Y 分别进行标准化处理（均值 = 0，方差 = 1），消除量纲差异，标准化公式为：（为均值，为标准差）。
3. 数据验证：检查标准化后的数据是否存在异常值（如 NaN、无穷大），若有需通过插值或删除处理。

（三）PCA 故障诊断实验（必做）
1. 正常模型训练：
基于标准化后的正常样本过程变量 X_normal_std，构建 PCA 模型，保留累计方差贡献率≥85% 的主成分。
计算 T² 控制限（基于 F 分布，置信水平 99%）和 SPE 控制限（基于卡方分布，置信水平 99%），公式如下：
T² 控制限：（k 为主成分个数，n 为正常样本数）
SPE 控制限：（m 为过程变量个数）
2. 故障检测：
将标准化后的故障样本过程变量 X_fault_std 代入 PCA 模型，计算每个故障样本的 T² 和 SPE 值。
对比故障样本的 T²、SPE 值与控制限，记录是否超出阈值，统计故障检测率。
3. 故障隔离：
绘制故障样本的 T² 贡献图和 SPE 贡献图，识别对统计量超标贡献最大的前 3 个过程变量。
4. 结果可视化：
绘制正常样本与故障样本的 T²-SPE 散点图，标注控制限，直观展示故障样本的偏离情况。

（四）PLS 故障诊断实验（选做实验）
1. 正常模型训练：
基于标准化后的正常样本 X_normal_std 和 Y_normal_std，构建 PLS 回归模型，通过交叉验证（5 折）确定最优主成分个数。
计算 PRESS 控制限（置信水平 99%），基于正常样本的预测误差分布确定阈值。
2. 故障检测：
将 X_fault_std 代入 PLS 模型，预测故障样本的质量变量 Y_pred，计算 PRESS 值（PRESS = \sum(Y_{fault} - Y_{pred})^2）。
对比 PRESS 值与控制限，判定故障是否被检测到。
3. 故障溯源：
分析 PLS 载荷矩阵，找出与质量变量（如密度）相关性最强的前 3 个过程变量，结合故障机理分析其合理性